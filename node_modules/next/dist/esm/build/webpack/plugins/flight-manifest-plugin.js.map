{"version":3,"sources":["../../../../src/build/webpack/plugins/flight-manifest-plugin.ts"],"names":["path","webpack","sources","CLIENT_REFERENCE_MANIFEST","SYSTEM_ENTRYPOINTS","relative","getProxiedPluginState","nonNullable","WEBPACK_LAYERS","pluginState","serverModuleIds","edgeServerModuleIds","ASYNC_CLIENT_MODULES","getAppPathRequiredChunks","chunkGroup","chunks","map","requiredChunk","has","name","files","file","endsWith","id","flat","filter","mergeManifest","manifest","manifestToMerge","Object","assign","clientModules","ssrModuleMapping","edgeSSRModuleMapping","entryCSSFiles","PLUGIN_NAME","ClientReferenceManifestPlugin","constructor","options","dev","appDir","appDirBase","dirname","sep","Set","apply","compiler","hooks","compilation","tap","normalModuleFactory","dependencyFactories","set","dependencies","ModuleDependency","dependencyTemplates","NullDependency","Template","processAssets","stage","Compilation","PROCESS_ASSETS_STAGE_OPTIMIZE_HASH","assets","createAsset","context","manifestsPerGroup","Map","chunkGroups","forEach","entryName","test","chunkEntryName","replace","getFiles","f","startsWith","requiredChunks","recordModule","mod","layer","appClient","resource","type","_identifier","slice","lastIndexOf","moduleReferences","moduleIdMapping","edgeModuleIdMapping","ssrNamedModuleId","resourceResolveData","isAsyncModule","esmResource","addClientReference","exportName","async","edgeExportName","addSSRIdMapping","chunk","entryMods","chunkGraph","getChunkEntryModulesIterable","request","includes","connections","moduleGraph","getOutgoingConnections","connection","dependency","clientEntryMod","getResolvedModule","modId","getModuleId","module","concatenatedMod","concatenatedModId","groupName","get","push","entryNameWithoutNamedSegments","groupNameWithoutNamedSegments","mergedManifest","segments","split","group","segment","json","JSON","stringify","pagePath","RawSource","length"],"mappings":"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"}